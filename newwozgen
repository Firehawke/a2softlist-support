#!/bin/bash
SAVEIFS=$IFS
IFS=$(echo -en "\n\b")
# Remove and recreate the work directories so they're clean.
rm -rf wozoutput 2> /dev/null
rm -rf wozstaging 2> /dev/null
mkdir xml 2> /dev/null
mkdir xml/woz 2> /dev/null
mkdir postsorted 2> /dev/null
mkdir wozoutput 2> /dev/null
mkdir wozstaging 2> /dev/null
# Do the actual search and download.
echo -e "Beginning work on entry [$1].."
ia search 'collection:wozaday' --parameters="page=$1&rows=1" --sort="publicdate desc" -i > currentitems.txt
# Major change: output download URLs to currentdls.txt
ia download -i --no-directories --glob '*.xml|*.woz|*.zip' -d --destdir="./wozstaging" --itemlist=currentitems.txt > currentdls.txt
# Let's remove the extras file and certain other unwanted materials
sed -i '/%20extras%20/d' currentdls.txt
sed -i '/0playable/d' currentdls.txt
sed -i '/_files.xml/d' currentdls.txt
# Now we download.
echo "Downloading..."
wget -q -i currentdls.txt -nc --show-progress -nd -P ./wozstaging
# Now let's decompress any ZIP files we got, forced lowercase names.
unzip -n -qq -LL -j "wozstaging/*.zip" -d wozoutput 2> /dev/null
# Move the meta XML and the disk images to the output folder for processing.
mv wozstaging/*.woz wozoutput 2> /dev/null
cp wozstaging/*meta.xml wozoutput 2> /dev/null
cd wozoutput
# Remove stuff we don't want. We don't want to parse the playable.dsk because
# that's an exact copy of the properly named disk. We don't want pictures and
# videos in this case either.
rm 00playable.woz 2> /dev/null
rm playable.woz 2> /dev/null
rm *.a2r 2> /dev/null
rm *.png 2> /dev/null
rm *.mp4 2> /dev/null
rm *.jpg 2> /dev/null
# These next two files seem to pop up a lot with MP4 files, which we don't want.
rm ProjFileList.xml 2> /dev/null
rm project.xml 2> /dev/null
# 4AM sometimes leaves his work disk in the package. We don't want to keep that.
rm *work\ disk* 2> /dev/null
rm *demuffin\'d\ only* 2> /dev/null
# Remove any existing XML file with the same number so we start clean.
rm ../xml/woz/woz$1.xml 2> /dev/null
#Now we start parsing each XML, of which there GENERALLY should only be one.
for filename in *.xml; do
	[ -e "$filename" ] || continue
	# We'll have to handcraft the shortname ourselves.
	echo -e '\t<software name="namehere">' >> ../xml/woz/woz$1.xml
	echo -e -n '\t\t<description>' >> ../xml/woz/woz$1.xml
	xmllint --xpath 'metadata/title/text()' "$filename" | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e '</description>' >> ../xml/woz/woz$1.xml
	echo -e -n '\t\t<year>' >> ../xml/woz/woz$1.xml
	xmllint --xpath 'metadata/description/text()' $filename | grep -o '19[0123456789][0123456789]' | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e '</year>' >> ../xml/woz/woz$1.xml
	echo -e -n '\t\t<publisher>' >> ../xml/woz/woz$1.xml
	xmllint --xpath 'metadata/description/text()' $filename | grep -o -a -i -F -f ../publishers.txt | tr -d '\n' | sed -e 's/distributed by //g' | sed -e 's/published by //g' | sed -e 's/\&amp;amp;/and/g' >> ../xml/woz/woz$1.xml
	echo -e '</publisher>' >> ../xml/woz/woz$1.xml
	echo -e -n '\t\t<info name="release" value="' >> ../xml/woz/woz$1.xml
	xmllint --xpath 'metadata/addeddate/text()' $filename | awk '{print $1}' | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e '"/>' >> ../xml/woz/woz$1.xml
	compatdata=$(xmllint --xpath 'metadata/description/text()' $filename | tr -d '\n')
	case $compatdata in
		*"It runs on any Apple ][ with 32K."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2,A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It runs on any Apple II with 32K. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It runs on any Apple ][ with 48K."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2,A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It runs on any Apple II with 48K. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It runs on any Apple ][ with 48K. The double hi-res version is automatically selected if you have a 128K Apple //e or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2,A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It runs on any Apple ][ with 48K. -->\n\t\t<!-- The double hi-res version is automatically selected if you have a 128K Apple //e or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires a 48K Apple ][+ or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 48K Apple ][+ or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requirs a 64K Apple ][+ or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 64K Apple ][+ or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires a 64K Apple ][+ or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 64K Apple ][+ or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires 64K Apple ][+ or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 64K Apple ][+ or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires a 64K Apple //e or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 64K Apple //e or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires a 128K Apple //e or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 128K Apple //e or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires 128K Apple //e or later."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 128K Apple //e or later. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires a 128K Apple //e, //c, or IIgs."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires a 128K Apple //e, //c, or IIgs. -->' >> ../xml/woz/woz$1.xml
			;;
		*"It requires an Apple ][ or ][+ with 48K. Due to compatibiltiy issues created by the copy protection, it will not run on later models."*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2,A2P" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It requires an Apple ][ or ][+ with 48K\n\t\tDue to compatibiltiy issues created by the copy protection,\n\t\tit will not run on later models. -->' >> ../xml/woz/woz$1.xml
			;;
		*)
			echo -e '\t\t<sharedfeat name="compatibility" value="A2,A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
			echo -e '\t\t<!-- It runs on any Apple II with 48K. -->' >> ../xml/woz/woz$1.xml
			;;
	esac
	# Obviously you'll need to hand-configure the compatibility because there's a lot of ways this can be described...
	#echo -e '\t\t<sharedfeat name="compatibility" value="A2,A2P,A2E,A2EE,A2C,A2GS" />' >> ../xml/woz/woz$1.xml
	#echo -e '\t\t<!-- It runs on any Apple II with 48K. -->' >> ../xml/woz/woz$1.xml
	echo -e -n '\t\t<!--' >> ../xml/woz/woz$1.xml
	xmllint --xpath 'metadata/description/text()' $filename | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e -n '-->\n' >> ../xml/woz/woz$1.xml
done
# Now we start working on the disk images. Here's where things get a Little
# hairy. We need both the proper (possibly bad)-cased filename for tools, but
# we need a forced lowercase for the XML.
# Clrmamepro will rename files automagically so the the files are fine as-is;
# we won't be renaming.
disknum=1
for filename in *.woz; do
	[ -e "$filename" ] || continue
	# Here we're generating a forced lowercase version of the name which we'll
	# use in some places in the XML.
	lfilename=$(echo "$filename" | tr '[:upper:]' '[:lower:]' )
	echo -e "Generating disk $disknum with file $lfilename.."
	# Critical: Check for SHA1 dupes.
	# Generate the SHA1 and put it in temp.
	sha1sum $filename | awk '{print $1}' > temp
	# Show on-screen if we got a dupe.
	#grep -a -i -F -n -R -f temp /mnt/c/msys64/src/mame/hash/apple2_flop*.xml
	# If we got a dupe, put it in temp2, otherwise leave a 0-byte file.
	grep -a -i -F -n -R -f temp /mnt/c/msys64/src/mame/hash/apple2_flop*.xml > temp2
	if [[ -s temp2 ]]; then
		echo "dupe" > dupecheck
	fi
	# Start outputting disk information.
	echo -e -n '\t\t<part name="flop' >> ../xml/woz/woz$1.xml
	echo -e -n $disknum >> ../xml/woz/woz$1.xml
	echo -e -n '" interface="' >> ../xml/woz/woz$1.xml

	# Now, is this a 5.25" or 3.5"?
	disktype=$((16#$(xxd -e -p -l1 -s 21 "$filename")))
	case $disktype in
		*"2"*)
			echo -e 'floppy_3_5">' >> ../xml/woz/woz$1.xml
			;;
		*)
			echo -e 'floppy_5_25">' >> ../xml/woz/woz$1.xml
			;;
	esac

	# Generate side/disk number information.

	case $lfilename in

		# "Disk X - Title" type
		# e.g. "swordthrust (4am crack) disk 1 - the king's testing ground.dsk"
		*"disk 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 11 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 11 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 12 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 12 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 13 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 13 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 14 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 14 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 15 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 15 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 16 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 16 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 17 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 17 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 18 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 18 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 19 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 19 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 20 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 20 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 21 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 21 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 22 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 22 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 23 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 23 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 24 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 24 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 25 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 25 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 26 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 26 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 27 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 27 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 28 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 28 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 29 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 29 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 30 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 30 - "/>' >> ../xml/woz/woz$1.xml
			;;

		# "Disk X" type
		# e.g. "read and spell - in the days of knights and castles (4am crack) disk 1.dsk"
		*"disk 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10"/>' >> ../xml/woz/woz$1.xml
			;;

		# "Disk X Side X" type
		# e.g. "read n roll (4am crack) disk 2 side a.dsk"
		*"disk 1 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 1 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10 side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10 side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 Side B"/>' >> ../xml/woz/woz$1.xml
			;;

		# "Disk X" type
		*"disk a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z"/>' >> ../xml/woz/woz$1.xml
			;;

		# "Disk X Side A/B" type
		*"disk a side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk a side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z Side B"/>' >> ../xml/woz/woz$1.xml
			;;

		# "Disk X Side X" type
		# e.g. "the perfect score (4am crack) disk a side 1 - antonyms i.dsk"
		*"disk a side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk a side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z side 1 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z Side 1 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z side 2 -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z Side 2 - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk a side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk a side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk A Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk b side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk B Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk c side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk C Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk d side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk D Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk e side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk E Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk f side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk F Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk g side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk G Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk h side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk H Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk i side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk I Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk j side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk J Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk k side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk K Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk l side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk L Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk m side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk M Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk n side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk N Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk o side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk O Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk p side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk P Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk q side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Q Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk r side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk R Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk s side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk S Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk t side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk T Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk u side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk U Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk v side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk V Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk w side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk W Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk x side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk X Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk y side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Y Side 2"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk z side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk Z Side 2"/>' >> ../xml/woz/woz$1.xml
			;;

		# "Disk X Side X - Title" type
		# e.g. "superprint (4am crack) disk 1 side a - program.dsk"
		*"disk 1 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 1 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10 side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10 side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 Side B - "/>' >> ../xml/woz/woz$1.xml
			;;

		# Disk NumberSide.
		# e.g. "voyage of the mimi (4am crack) disk 1a.dsk"
		*"disk 1a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 1b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 1 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 2b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 2 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 3b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 3 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 4b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 4 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 5b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 5 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 6b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 6 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 7b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 7 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 8b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 8 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 9b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 9 Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10a."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"disk 10b."*)
			echo -e '\t\t\t<feature name="part_id" value="Disk 10 Side B"/>' >> ../xml/woz/woz$1.xml
			;;

		# Because case is a fallthrough, it only ever gets here if it fails to match
		# one of the above entries.

		# "Side X - Title" type
		# e.g. "the bard's tale ii (4am and san inc crack) side a - program.dsk"
		*"side a -"*)
			echo -e '\t\t\t<feature name="part_id" value="Side A - "/>' >> ../xml/woz/woz$1.xml
			;;
		*"side b -"*)
			echo -e '\t\t\t<feature name="part_id" value="Side B - "/>' >> ../xml/woz/woz$1.xml
			;;

		# "Side X" type
		# e.g. "reading and me (4am crack) side a.dsk"
		*"side a."*)
			echo -e '\t\t\t<feature name="part_id" value="Side A"/>' >> ../xml/woz/woz$1.xml
			;;
		*"side b."*)
			echo -e '\t\t\t<feature name="part_id" value="Side B"/>' >> ../xml/woz/woz$1.xml
			;;
		*"side 1."*)
			echo -e '\t\t\t<feature name="part_id" value="Side 1"/>' >> ../xml/woz/woz$1.xml
			;;
		*"side 2."*)
			echo -e '\t\t\t<feature name="part_id" value="Side 2"/>' >> ../xml/woz/woz$1.xml
			;;

		# Special cases. Will add as they come up.
		*"side 2 (boot)."*)
			echo -e '\t\t\t<feature name="part_id" value="Side 2 - Boot"/>' >> ../xml/woz/woz$1.xml
			;;
	esac

	# Give us the actual floppy definition, including size.
	echo -e -n '\t\t\t<dataarea name="flop" size="' >> ../xml/woz/woz$1.xml
	wc "$filename" | awk '{print $3}' | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e '">' >> ../xml/woz/woz$1.xml
	echo -e -n '\t\t\t\t<rom name="' >> ../xml/woz/woz$1.xml
	# BUT! Give us the lowercase filename in the XML definition.
	echo -e -n $lfilename >> ../xml/woz/woz$1.xml
	# As always, tools use case of what's there.
	echo -e -n '" size="' >> ../xml/woz/woz$1.xml
	wc "$filename" | awk '{print $3}' | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e -n '" crc="' >> ../xml/woz/woz$1.xml
	crc32 $filename | awk '{print $1}' | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e -n '" sha1="' >> ../xml/woz/woz$1.xml
	sha1sum $filename | awk '{print $1}' | tr -d '\n' >> ../xml/woz/woz$1.xml
	echo -e '" />' >> ../xml/woz/woz$1.xml
	echo -e '\t\t\t</dataarea>' >> ../xml/woz/woz$1.xml
	echo -e '\t\t</part>' >> ../xml/woz/woz$1.xml
	((disknum++))
done
echo -e '\t</software>\n' >> ../xml/woz/woz$1.xml
# Clean out the woz-a-day collection tags.
sed -i 's/ (woz-a-day collection)<\/description>/<\/description>/g' ../xml/woz/woz$1.xml
sed -i 's/ 800K / (800K 3.5") /g' ../xml/woz/woz$1.xml
# Detect if we didn't get a publisher and add a warning notification.
sed -i 's/<publisher><\/publisher>/<publisher>UNKNOWN<\/publisher>/g' ../xml/woz/woz$1.xml
# If the temp2 file above says this already exists in our MAME softlists,
# then all this work was a waste and we need to delete the XML now.
if [[ -s dupecheck ]]; then
	echo -e "Duplicated entry. Removing generated XML..."
	rm ../xml/woz/woz$1.xml
	echo -e "------"
	exit 1
fi
# Migrate all non-duplicate .woz images to the postsorted folder for later Clrmamepro
# parsing so we can be 100% sure the XML is correct even after mame -valid
mv *.woz ../postsorted 2> /dev/null
cd ..
echo -e "------"
IFS=$SAVEIFS
